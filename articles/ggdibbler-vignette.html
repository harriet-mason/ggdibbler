<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>An introduction to ggdibbler • ggdibbler</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An introduction to ggdibbler">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggdibbler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/ggdibbler-vignette.html">An introduction to ggdibbler</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>An introduction to ggdibbler</h1>
            
      

      <div class="d-none name"><code>ggdibbler-vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="about">About<a class="anchor" aria-label="anchor" href="#about"></a>
</h2>
<p><code>ggdibbler</code> is an R package for implementing signal
suppression in ggplot2. Usually, uncertainty visualisation focuses on
expressing uncertainty as a distribution or probability, whereas
ggdibble differentiates itself by viewing an uncertainty visualisation
as a transformation of an existing graphic that incorperates
uncertainty. The package allows you to replace any existing variable of
observations in a graphic, with a variable of distributons. It is
particularly useful for visualisations of estimates, such as a mean. You
provide ggdibble with code for an existing plot, but repalace one of the
variables with a distribution, and it will convert the visualisation
into it’s signal supressed counterpart.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of ggdibbler from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"harriet-mason/ggdibbler"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>It may not be obvious from the outset why we would want this package,
after all, there are plenty of geoms and plenty of ways to visualise
distributions, so what is the point of this? The value of
<code>ggdibbler</code> becomes aparent when we look at a couples of use
cases for the software.</p>
<p>Currently, the primary useage of ggdibbler is to provide several
variations on <code>geom_sf</code>. There are other use cases for
<code>ggdibbler</code> as we will see below, but as of right now, the
variation on other geoms are not as fleshed out.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://harriet-mason.github.io/ggdibbler/">ggdibbler</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.mitchelloharawild.com/distributional/" class="external-link">distributional</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="spatial-example">Spatial example<a class="anchor" aria-label="anchor" href="#spatial-example"></a>
</h3>
<p>Let us look at one of the example data sets that comes with
<code>ggdibbler</code>,<code>toy_temp</code>. This data set is a
simulated data set that represents observations collected from citizen
scientists in several counties in Iowa. Each county has several
measurements made by individual scientists at the same time on the same
day, but their exact location is not provided to preserve anonymity.
Different counties can have different numbers of citizen scientists and
the temperature measurements can have a significant amount of variance
due to the recordings being made by different people in slightly
different locations within the county. Each recorded temperature comes
with the county the citizen scientist belongs to, the temperature
recording the made, and the scientist’s ID number. There are also
variables to define spatial elements of the county, such as it’s
geometry, and the county centroid’s longitude and latitude.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">toy_temp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 990</span></span>
<span><span class="co">#&gt; Columns: 6</span></span>
<span><span class="co">#&gt; $ county_name      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Lyon County"<span style="color: #949494;">, </span>"Dubuque County"<span style="color: #949494;">, </span>"Crawford County"<span style="color: #949494;">, </span>"…</span></span>
<span><span class="co">#&gt; $ county_geometry  <span style="color: #949494; font-style: italic;">&lt;MULTIPOLYGON [m]&gt;</span> MULTIPOLYGON (((274155.2 -1...<span style="color: #949494;">, </span>MULTIPOL…</span></span>
<span><span class="co">#&gt; $ county_longitude <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 306173.3<span style="color: #949494;">, </span>746092.2<span style="color: #949494;">, </span>381255.2<span style="color: #949494;">, </span>696287.1<span style="color: #949494;">, </span>729905.9<span style="color: #949494;">, </span>306…</span></span>
<span><span class="co">#&gt; $ county_latitude  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -172880.7<span style="color: #949494;">, </span>-239861.5<span style="color: #949494;">, </span>-318675.9<span style="color: #949494;">, </span>-153979.0<span style="color: #949494;">, </span>-280551.9…</span></span>
<span><span class="co">#&gt; $ recorded_temp    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 21.08486<span style="color: #949494;">, </span>28.94271<span style="color: #949494;">, </span>26.39905<span style="color: #949494;">, </span>27.10343<span style="color: #949494;">, </span>34.20208<span style="color: #949494;">, </span>20.…</span></span>
<span><span class="co">#&gt; $ scientistID      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "#74991"<span style="color: #949494;">, </span>"#22780"<span style="color: #949494;">, </span>"#55325"<span style="color: #949494;">, </span>"#46379"<span style="color: #949494;">, </span>"#84259"<span style="color: #949494;">, </span>"#9…</span></span></code></pre></div>
<p>While it is slightly difficult, we can view the individual
observations by plotting them to the centroid longitude and latitude
(with a little jitter) and drawing the counties in the background for
referece.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot Raw Data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">toy_temp</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry<span class="op">=</span><span class="va">county_geometry</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">county_longitude</span>, y<span class="op">=</span><span class="va">county_latitude</span>, colour<span class="op">=</span><span class="va">recorded_temp</span><span class="op">)</span>, </span>
<span>              width<span class="op">=</span><span class="fl">5000</span>, height <span class="op">=</span><span class="fl">5000</span>, alpha<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggdibbler-vignette_files/figure-html/unnamed-chunk-3-1.png" width="700">
Typically, we would not visualise the data this way. A much more common
approach would be to take the average of each county and display that in
a choropleth map, displayed below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mean data</span></span>
<span><span class="va">toy_temp_mean</span> <span class="op">&lt;-</span> <span class="va">toy_temp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">county_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>temp_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">recorded_temp</span><span class="op">)</span><span class="op">)</span> </span>
<span>  </span>
<span><span class="co"># Plot Mean Data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">toy_temp_mean</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry<span class="op">=</span><span class="va">county_geometry</span>, fill<span class="op">=</span><span class="va">temp_mean</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggdibbler-vignette_files/figure-html/unnamed-chunk-4-1.png" width="700">
This plot is fine, but it does loose a key piece of information,
specifically the understanding that this mean is an estimate. That means
that this estimate has a sampling distribuiton that is invisible to us
when we make this visualisation.</p>
<p>We can see that there is a wave like pattern in the data, but
sometimes spatial patterns are a result of significant differences in
population, and may disappear if we were to include the variance of the
estimates, we can calculate that with the average.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mean and variance data</span></span>
<span><span class="va">toy_temp_est</span> <span class="op">&lt;-</span> <span class="va">toy_temp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">county_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>temp_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">recorded_temp</span><span class="op">)</span>,</span>
<span>            temp_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">recorded_temp</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>Getting an estimate along with its variance is also a common format
governments supply data. Just like in our citizen scientist case, this
if often done to preserve anonymity.</p>
<p>The problem with this format of data, is that there is no way for us
to include the variance information in the visualisation. We can only
visualise the estimate and its variance separately.</p>
<p>This is where ggdibbler comes in. <code>ggdibbler</code> is a ggplot
extension that allows us to visulise distributions where we could
previously only visualise single values. Instead of trying to use the
estimate and its variance as different values, we combine them as a
single distribution variable thanks to the <code>distributional</code>
package and then can use it with the <code>ggdibbler</code> version of
<code>geom_sf</code>, <code>geom_sf_sample</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Distribution</span></span>
<span><span class="va">toy_temp_dist</span> <span class="op">&lt;-</span> <span class="va">toy_temp_est</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>temp_dist <span class="op">=</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="va">temp_mean</span>, <span class="va">temp_se</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">county_name</span>, <span class="va">temp_dist</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Plot Distribution Data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">toy_temp_dist</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_sf_sample.html">geom_sf_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry<span class="op">=</span><span class="va">county_geometry</span>, fill<span class="op">=</span><span class="va">temp_dist</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ggdibbler-vignette_files/figure-html/unnamed-chunk-6-1.png" width="700">
To maintain flexibility, the <code>geom_sf_sample</code> does not
highlight the original boundary lines, but that can be easily added just
by adding another layer.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">toy_temp_dist</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_sf_sample.html">geom_sf_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">county_geometry</span>, fill<span class="op">=</span><span class="va">temp_dist</span><span class="op">)</span>, linewidth<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">county_geometry</span><span class="op">)</span>, fill<span class="op">=</span><span class="cn">NA</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ggdibbler-vignette_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="scatter-plot-example">Scatter plot example<a class="anchor" aria-label="anchor" href="#scatter-plot-example"></a>
</h3>
</div>
<div class="section level3">
<h3 id="distribution-example">Distribution example<a class="anchor" aria-label="anchor" href="#distribution-example"></a>
</h3>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Harriet Mason, Dianne Cook, Sarah Goodwin, Susan VanderPlas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
