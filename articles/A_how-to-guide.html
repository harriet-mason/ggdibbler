<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Get started with ggdibbler • ggdibbler</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get started with ggdibbler">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggdibbler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/A_how-to-guide.html">Get started with ggdibbler</a></li>
    <li><a class="dropdown-item" href="../articles/B_ggdibbler-philosophy.html">The philosophy of ggdibbler</a></li>
    <li><a class="dropdown-item" href="../articles/C_random-plots.html">Unexpected behaviour of random plots</a></li>
    <li><a class="dropdown-item" href="../articles/D_extender-info.html">Help for ggplot extenders</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/harriet-mason/ggdibbler/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get started with ggdibbler</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/harriet-mason/ggdibbler/blob/main/vignettes/A_how-to-guide.Rmd" class="external-link"><code>vignettes/A_how-to-guide.Rmd</code></a></small>
      <div class="d-none name"><code>A_how-to-guide.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="tldr---what-is-ggdibbler">TLDR - What is <code>ggdibbler</code>?<a class="anchor" aria-label="anchor" href="#tldr---what-is-ggdibbler"></a>
</h3>
<p>You can pass random variables to ggplot now. Any geom, any aesthetic
(except groups and facets), they all accept random variables. we make no
judgements on your plot, we am not your rulers. Whatever your plot is,
<code>ggdibbler</code> will allow you to pass a random variable to it.
The rest of the vignette will explain how this works and the philosophy
behind it. I know you are itching to get to the package, so I will
quickly answer the main question I know you are dying to ask: Yes, I DO
accept cash gifts as expressions of gratitude, cheers.</p>
</div>
<div class="section level2">
<h2 id="the-unfamiliar-stuff">The unfamiliar stuff<a class="anchor" aria-label="anchor" href="#the-unfamiliar-stuff"></a>
</h2>
<p>This is a brief explanation of the things you might not already be
familiar with when learning about <code>ggdibbler</code>.</p>
<div class="section level3">
<h3 id="using-distributional">Using distributional<a class="anchor" aria-label="anchor" href="#using-distributional"></a>
</h3>
<p><code>ggdibbler</code> is entirely built upon the R package
<code>distributional</code> which allows you to store distributions in a
data frame as distribution objects. The package is the foundation of
<code>ggdibbler</code> because it perfectly embodies the concept of a
random variable as a unit. The package is also shockingly flexible and I
am yet to come across a case that cannot be represented by
<code>distributional</code>. If you have uncertainty that can quantified
then it can be represented in a vector and therefore can be visualised
by <code>ggdibbler</code>.</p>
<ul>
<li>Bounded values? use
<code>dist_uniform(lowerbound, upperbound)</code>
</li>
<li>Uncertain predicted classes? use <code>dist_categorical</code>
</li>
<li>Want to sample values from a specific vector of values (such as a
posterior)? use <code>dist_sample</code>
</li>
<li>Classic empirical distribution? Go buck wild with
<code>dist_normal</code>, <code>dist_poission</code>, and the like</li>
</ul>
<p>There are also flexibilities that go beyond just the distribution you
choose.</p>
<ul>
<li>You can transform distributions using standard arithmetic (in
sensible situations) or with <code>dist_transformed</code>
</li>
<li>You can make mixed distributions using <code>dist_mixture</code> and
truncate distributions with <code>dist_truncated</code>
</li>
<li>You can make your own bespoke distributions (although I am not sure
how difficult that is, I have never had to do it).</li>
<li>You can even have deterministic (there is a deterministic
distribution) and distributional objects in the same column.</li>
</ul>
<p>To give an example of the transformations, I just ripped the code
below from one of Mitch’s talks on the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;distribution[1]&gt;</span></span>
<span><span class="co">#&gt; [1] N(1, 9)</span></span>
<span></span>
<span><span class="co"># if transformation exists</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;distribution[1]&gt;</span></span>
<span><span class="co">#&gt; [1] lN(9, 81)</span></span>
<span></span>
<span><span class="co"># if transformation doesn't exist uses dist_transformed</span></span>
<span><span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">#&gt; &lt;distribution[1]&gt;</span></span>
<span><span class="co">#&gt; [1] t(N(9, 81))</span></span></code></pre></div>
<p>All of the data sets in <code>ggdibbler</code> already have the
distributional component added, but making a distribution vector is
shockingly easy. Below is an example where we make normally distributed
estimates by wrapping our typical estimate and standard error
calculations in a <code>dist_normal</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">toy_temp_eg</span> <span class="op">&lt;-</span> <span class="va">toy_temp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">county_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>temp_dist <span class="op">=</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">recorded_temp</span><span class="op">)</span>,</span>
<span>                                    sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">recorded_temp</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">toy_temp_eg</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 406217.2 ymin: -466551.1 xmax: 722461.8 ymax: -128604.1</span></span>
<span><span class="co">#&gt; Projected CRS: NAD27 / US National Atlas Equal Area</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   county_name    temp_dist</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dist&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Adair County N(30, 0.82)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Adams County    N(30, 1)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Allamakee C…  N(26, 0.3)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Appanoose C… N(23, 0.69)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Audubon Cou…  N(28, 0.8)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Benton Coun…    N(29, 2)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: county_geometry &lt;MULTIPOLYGON [m]&gt;</span></span></span></code></pre></div>
<p>Now, I could spend all day on this, but ultimately, this is not a
vignette for distributional (although they really should make one). It
is definitely worth having a play around in <code>distributional</code>
to get a feel for the package if you have never used it before.</p>
</div>
<div class="section level3">
<h3 id="using-nested-positions">Using nested positions<a class="anchor" aria-label="anchor" href="#using-nested-positions"></a>
</h3>
<p>Another component of <code>ggdibbler</code> that is not always
immediately clear to users is the nested position system. This system is
required to maintain the continuous mapping property that makes
<code>ggdibbler</code> such a useful uncertainty visualisation
system.</p>
<p>The syntax of the nested positions is
<code>mainposition_nestedposition</code>, where the main position is
what was in the limiting ggplot, and the nested position manages the
over plotting caused by sampling from the distribution.</p>
<p>To get an idea of how the nested positions work, we have included a
few examples using the identity, dodge and stack positions and am
showing them alongside their <code>ggplot2</code> deterministic
counterpart. The first column is the original ggplot we are going to add
uncertainty to, the second and third column is the effect of the over
plotting being managed with an identity (with decreased alpha) and dodge
positions respectively.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ggplot IDENTITY</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_bar_sample.html">geom_bar_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">drv</span><span class="op">)</span>, </span>
<span>                  position <span class="op">=</span> <span class="st">"identity"</span>, alpha<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_few</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span>, aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"ggplot2: identity"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ggdibbler identity</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">uncertain_mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_bar_sample.html">geom_bar_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">drv</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>                  position <span class="op">=</span> <span class="st">"identity_identity"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_few</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span>, aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"identity_identity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">uncertain_mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_bar_sample.html">geom_bar_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">drv</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.7</span>,</span>
<span>                  position <span class="op">=</span> <span class="st">"identity_dodge"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_few</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span>, aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"identity_dodge"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># ggplot dodge</span></span>
<span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_bar_sample.html">geom_bar_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">drv</span><span class="op">)</span>, </span>
<span>                  position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>preserve<span class="op">=</span><span class="st">"single"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_few</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span>, aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"ggplot: dodge"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">uncertain_mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_bar_sample.html">geom_bar_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">drv</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>                  position <span class="op">=</span> <span class="st">"dodge_identity"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_few</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span>, aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"dodge_identity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">uncertain_mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_bar_sample.html">geom_bar_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">drv</span><span class="op">)</span>, </span>
<span>                  position <span class="op">=</span> <span class="st">"dodge_dodge"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_few</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span>, aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"dodge_dodge"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># ggplot stack</span></span>
<span><span class="va">p9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_bar_sample.html">geom_bar_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">drv</span><span class="op">)</span>, </span>
<span>                  position <span class="op">=</span> <span class="st">"stack"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_few</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span>, aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"ggplot2: stack"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">uncertain_mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_bar_sample.html">geom_bar_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">drv</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>                  position <span class="op">=</span> <span class="st">"stack_identity"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_few</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span>, aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"stack_identity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">uncertain_mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_bar_sample.html">geom_bar_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">drv</span><span class="op">)</span>,</span>
<span>                  position <span class="op">=</span> <span class="st">"stack_dodge"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_few</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span>, aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"stack_dodge"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span> <span class="op">|</span> <span class="va">p3</span> <span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p5</span> <span class="op">|</span> <span class="va">p6</span> <span class="op">|</span> <span class="va">p7</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p9</span> <span class="op">|</span> <span class="va">p10</span> <span class="op">|</span> <span class="va">p11</span><span class="op">)</span></span></code></pre></div>
<p><img src="A_how-to-guide_files/figure-html/figuregrid-1.png" class="r-plt" width="1536"></p>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="working-directly-with-model-output">Working directly with model output<a class="anchor" aria-label="anchor" href="#working-directly-with-model-output"></a>
</h3>
<p>Sometimes you will get lucky and the modelling package you are using
will directly spit out a <code>distributional</code> objects. This is
the case in a package such as <code>fable</code>. In this case, you can
literally just directly visualise the distributions with zero
pre-processing</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecast</span> <span class="op">&lt;-</span> <span class="fu">as_tsibble</span><span class="op">(</span><span class="va">sunspot.year</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">model</span><span class="op">(</span><span class="fu">ARIMA</span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">forecast</span><span class="op">(</span>h <span class="op">=</span> <span class="st">"10 years"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">forecast</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_path_sample.html">geom_line_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">index</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span>,</span>
<span>                       times<span class="op">=</span><span class="fl">100</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_few</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="A_how-to-guide_files/figure-html/forecast-1.png" class="r-plt" width="576"></p>
<p>This is not a common occurrence, but when it occurs the workflow is
so seamless that uncertainty visualisation becomes as easy as
visualising regular data. The more R programs that spit out a
distribution directly, the easier it will be for you to visualise
uncertainty. I cannot control this, but hopefully being able to
seamlessly visualise the distributions will make transparency in
predictions and model outputs seamless to implement into any data
analysis workflow.</p>
</div>
<div class="section level3">
<h3 id="a-basic-geom_abline">A basic <code>geom_abline</code><a class="anchor" aria-label="anchor" href="#a-basic-geom_abline"></a>
</h3>
<p>The most basic estimate we can have, is the estimate for a simple
linear regression. A simple linear regression is actually used in the
<code>ggplot2</code> documentation as the example for
<code>geom_abline</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot data</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_few</span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="A_how-to-guide_files/figure-html/abline1-1.png" class="r-plt" width="480"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate slope and intercept of line of best fit</span></span>
<span><span class="co"># get coef and standard error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = mpg ~ wt, data = mtcars)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -4.5432 -2.3647 -0.1252  1.4096  6.8727 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  37.2851     1.8776  19.858  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; wt           -5.3445     0.5591  -9.559 1.29e-10 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 3.046 on 30 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.7528, Adjusted R-squared:  0.7446 </span></span>
<span><span class="co">#&gt; F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ggplot, just error estimate</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">37</span>, slope <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># ggdibbler for coef AND standard error</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_abline_sample.html">geom_abline_sample</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">37</span>, <span class="fl">1.8</span><span class="op">)</span>, slope <span class="op">=</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">0.56</span><span class="op">)</span>,</span>
<span>                       times<span class="op">=</span><span class="fl">30</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span></code></pre></div>
<p><img src="A_how-to-guide_files/figure-html/abline2-1.png" class="r-plt" width="768"></p>
<p>A fun aspect of this approach, is that we can simultaneously see the
impact of the variance in the intercept <em>and</em> the slope.</p>
</div>
<div class="section level3">
<h3 id="a-more-complicated-case-with-geom_sf">A more complicated case with geom_sf<a class="anchor" aria-label="anchor" href="#a-more-complicated-case-with-geom_sf"></a>
</h3>
<p>Lets work through a longer and more difficult case of uncertainty
visualisation, that involves some actual data manipulation, statistical
thinking, and a somewhat complicated visualisation; a spatial
visualisation with an uncertain fill. To look at this, we are going to
use one of the example data sets that comes with
<code>ggdibbler</code>,<code>toy_temp</code>.</p>
<p>The <code>toy_temp</code> data set is a simulated data set that
represents observations collected from citizen scientists in several
counties in Iowa. Each county has several measurements made by
individual scientists at the same time on the same day, but their exact
location is not provided to preserve anonymity. Different counties can
have different numbers of citizen scientists and the temperature
measurements can have a significant amount of variance due to the
recordings being made by different people in slightly different
locations within the county. Each recorded temperature comes with the
county the citizen scientist belongs to, the temperature recording the
made, and the scientist’s ID number. There are also variables to define
spatial elements of the county, such as it’s geometry, and the county
centroid’s longitude and latitude.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">toy_temp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 990</span></span>
<span><span class="co">#&gt; Columns: 6</span></span>
<span><span class="co">#&gt; $ county_name      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Lyon County"<span style="color: #949494;">, </span>"Dubuque County"<span style="color: #949494;">, </span>"Crawford County"<span style="color: #949494;">, </span>"…</span></span>
<span><span class="co">#&gt; $ county_geometry  <span style="color: #949494; font-style: italic;">&lt;MULTIPOLYGON [m]&gt;</span> MULTIPOLYGON (((274155.2 -1...<span style="color: #949494;">, </span>MULTIPOL…</span></span>
<span><span class="co">#&gt; $ county_longitude <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 306173.3<span style="color: #949494;">, </span>746092.2<span style="color: #949494;">, </span>381255.2<span style="color: #949494;">, </span>696287.1<span style="color: #949494;">, </span>729905.9<span style="color: #949494;">, </span>306…</span></span>
<span><span class="co">#&gt; $ county_latitude  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -172880.7<span style="color: #949494;">, </span>-239861.5<span style="color: #949494;">, </span>-318675.9<span style="color: #949494;">, </span>-153979.0<span style="color: #949494;">, </span>-280551.9…</span></span>
<span><span class="co">#&gt; $ recorded_temp    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 21.08486<span style="color: #949494;">, </span>28.94271<span style="color: #949494;">, </span>26.39905<span style="color: #949494;">, </span>27.10343<span style="color: #949494;">, </span>34.20208<span style="color: #949494;">, </span>20.…</span></span>
<span><span class="co">#&gt; $ scientistID      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "#74991"<span style="color: #949494;">, </span>"#22780"<span style="color: #949494;">, </span>"#55325"<span style="color: #949494;">, </span>"#46379"<span style="color: #949494;">, </span>"#84259"<span style="color: #949494;">, </span>"#9…</span></span></code></pre></div>
<p>While it is slightly difficult, we can view the individual
observations by plotting them to the centroid longitude and latitude
(with a little jitter) and drawing the counties in the background for
referee.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot Raw Data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">toy_temp</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry<span class="op">=</span><span class="va">county_geometry</span><span class="op">)</span>, fill<span class="op">=</span><span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"ggdibbler some error"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">county_longitude</span>, y<span class="op">=</span><span class="va">county_latitude</span>, colour<span class="op">=</span><span class="va">recorded_temp</span><span class="op">)</span>, </span>
<span>              width<span class="op">=</span><span class="fl">5000</span>, height <span class="op">=</span><span class="fl">5000</span>, alpha<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"OrRd"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_map</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="A_how-to-guide_files/figure-html/sf2-1.png" class="r-plt" width="576"></p>
<p>Typically, we would not visualise the data this way. A much more
common approach would be to take the average of each county and display
that in a choropleth map, displayed below.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mean data</span></span>
<span><span class="va">toy_temp_mean</span> <span class="op">&lt;-</span> <span class="va">toy_temp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">county_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>temp_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">recorded_temp</span><span class="op">)</span><span class="op">)</span> </span>
<span>  </span>
<span><span class="co"># Plot Mean Data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">toy_temp_mean</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"ggdibbler some error"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"OrRd"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry<span class="op">=</span><span class="va">county_geometry</span>, fill<span class="op">=</span><span class="va">temp_mean</span><span class="op">)</span>, colour<span class="op">=</span><span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_map</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="A_how-to-guide_files/figure-html/sf3-1.png" class="r-plt" width="576"></p>
<p>This plot is fine, but it does loose a key piece of information,
specifically the understanding that this mean is an estimate. That means
that this estimate has a sampling distribution that is invisible to us
when we make this visualisation.</p>
<p>We can see that there is a wave like pattern in the data, but
sometimes spatial patterns are not the result of significant differences
in population, and may disappear if we were to include the variance of
the estimates. We can calculate the estimated standard error alongside
the mean.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mean and variance data</span></span>
<span><span class="va">toy_temp_est</span> <span class="op">&lt;-</span> <span class="va">toy_temp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">county_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>temp_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">recorded_temp</span><span class="op">)</span>,</span>
<span>            temp_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">recorded_temp</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>Getting an estimate along with its variance is also a common format
governments supply data. Just like in our citizen scientist case, this
if often done to preserve anonymity.</p>
<p>The problem with this format of data, is that there is no way for us
to include the variance information in the visualisation. We can only
visualise the estimate and its variance separately. So, instead of
trying to use the estimate and its variance as different values, we
combine them as a single distribution variable.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Distribution</span></span>
<span><span class="va">toy_temp_dist</span> <span class="op">&lt;-</span> <span class="va">toy_temp_est</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>temp_dist <span class="op">=</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="va">temp_mean</span>, <span class="va">temp_se</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">county_name</span>, <span class="va">temp_dist</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Plot Distribution Data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">toy_temp_dist</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_sf_sample.html">geom_sf_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry<span class="op">=</span><span class="va">county_geometry</span>, fill<span class="op">=</span><span class="va">temp_dist</span><span class="op">)</span>, </span>
<span>                 times<span class="op">=</span><span class="fl">50</span>, linewidth<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"OrRd"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">theme_map</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="A_how-to-guide_files/figure-html/sf5-1.png" class="r-plt" width="576"></p>
<p>To maintain flexibility, the <code>geom_sf_sample</code> does not
highlight the original boundary lines, but that can be easily added just
by adding another layer.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">toy_temp_dist</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_sf_sample.html">geom_sf_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">county_geometry</span>, fill<span class="op">=</span><span class="va">temp_dist</span><span class="op">)</span>, </span>
<span>                 linewidth<span class="op">=</span><span class="fl">0</span>, times<span class="op">=</span><span class="fl">50</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"OrRd"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">county_geometry</span><span class="op">)</span>, </span>
<span>          fill<span class="op">=</span><span class="cn">NA</span>, linewidth<span class="op">=</span><span class="fl">1</span>, colour<span class="op">=</span><span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_map</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="A_how-to-guide_files/figure-html/sf6-1.png" class="r-plt" width="576"></p>
<p>By default, <code>geom_sf_sample</code> will subdivide the data. It
is unlikely that you will ever notice this default, as the random part
in a geom_sf is almost always the fill, but in the unlikely event the
random object is the SF part, you will need to change the position to
<code>"identity"</code> and use <code>alpha</code> to manage over
plotting. Alternatively, making an animated plot (detailed below) also
requires the position to be changed to <code>"identity"</code>. Note
that unlike <code>geom_sf_sample</code>,
<code>geom_polygon_sample</code> does not have subdivide turned on by
default.</p>
<p>Subdivide is the only position that is specifically created for
<code>ggdibbler</code>. It was inspired by the pixel map used in <a href="https://github.com/lydialucchesi/Vizumap" class="external-link"><code>Vizumap</code></a>.
All the other position systems used are nested versions of the existing
<code>ggplot2</code> positions.</p>
</div>
<div class="section level3">
<h3 id="what-about-animated-plots">What about animated plots?<a class="anchor" aria-label="anchor" href="#what-about-animated-plots"></a>
</h3>
<p>Yup, you can do that too. It’s actually very simple. <a href="chrome-extension://efaidnbmnnnibpcajpcglclefindmkaj/https://idl.cs.washington.edu/files/2015-HOPs-PLOS.pdf" class="external-link">Hypothetical
outcome</a> plots have been suggested as an uncertainty visualisation
technique, and they are also easily implemented in
<code>ggdibbler</code>.</p>
<p>In a HOPs plot, it seems that animations replace our distribution
specific position adjustment and the continuous mapping theorem still
holds. As the variance of each random variable approaches 0, the
difference between the frames approaches zero until the animation looks
like a single static plot.</p>
<p>Implementing the code is trivially easy when we just have the
animation run through every draw using the <code>drawID</code> variable
(which is exactly what we do in the other position adjustments).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># bar chart</span></span>
<span><span class="va">hops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">uncertain_mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_bar_sample.html">geom_bar_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">drv</span><span class="op">)</span>,</span>
<span>                  position <span class="op">=</span> <span class="st">"stack_identity"</span>, times<span class="op">=</span><span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_few</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">transition_states</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">drawID</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">animate</span><span class="op">(</span><span class="va">hops</span>, renderer <span class="op">=</span>  <span class="fu">gifski_renderer</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="A_how-to-guide_files/figure-html/hops1-1.gif"><!-- --></p>
</div>
<div class="section level3">
<h3 id="what-if-my-plot-uses-ggplot2-extensions">What if my plot uses ggplot2 extensions?<a class="anchor" aria-label="anchor" href="#what-if-my-plot-uses-ggplot2-extensions"></a>
</h3>
<p>If you represent uncertainty as a distributional object, use the
<code>sample_expand</code> function, and group by <code>drawID</code>,
you can apply the signal suppression methods to literally any graphic.
It won’t always work as nicely as <code>ggdibbler</code> (please
download the package, it looks good on my CV and I need a job) and you
can’t use the nested position system, but it works well enough. Writing
extensions that use <code>ggdibbler</code> is covered in a separate
vignette.</p>
<p>This section will go through an example with <code>ggraph</code> and
uncertain edges. So you have this random data set.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">uncertain_edges</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>to <span class="op">=</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_sample.html" class="external-link">dist_sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">to</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>                                                 to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">to</span><span class="op">+</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                                      replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">uncertain_edges</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;    from        to weight</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dist&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     3 sample[3] 0.761 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 sample[2] 0.573 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     2 sample[3] 0.448 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     4 sample[3] 0.083<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     3 sample[2] 0.219 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     2 sample[3] 0.075<span style="text-decoration: underline;">6</span></span></span></code></pre></div>
<p>You need to apply <code>sample_expand</code> before you convert the
data to a graph, because <code>ggraph</code> is all totalitarian about
what it will keep in its graph data set, and it doesn’t allow
distributions.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph_sample</span> <span class="op">&lt;-</span> <span class="va">uncertain_edges</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/sample_expand.html">sample_expand</a></span><span class="op">(</span>times<span class="op">=</span><span class="fl">50</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">as_tbl_graph</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Now, the ideal visualisation would allow us to add transparency with
a small amount of jitter to straight lines. That doesn’t seem to be
possible in <code>ggraph</code> (as far as I can tell). It seems that,
similar to <code>ggplot2</code>, the lines are actually made up of many
individual points, and the line geometry simply interpolates between
them. When it applies the jitter, it does it to each point, rather than
the line as a whole. So, adding the jitter does work, it just doesn’t
work exactly as you might expect. It does produce an uncertainty
visualisation, though.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jitter</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.01</span>, height<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu">ggraph</span><span class="op">(</span><span class="va">graph_sample</span>, layout <span class="op">=</span> <span class="st">'fr'</span>, weights <span class="op">=</span> <span class="va">weight</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_edge_link</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group<span class="op">=</span><span class="va">drawID</span><span class="op">)</span>, position<span class="op">=</span><span class="va">jitter</span>, alpha<span class="op">=</span><span class="fl">0.1</span>, </span>
<span>                 linewidth<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_node_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="A_how-to-guide_files/figure-html/graph3-1.png" class="r-plt" width="576"></p>
<p>You can mess around with alpha, linewidth, and the times argument in
the <code>sample_expand</code> function to get something you are happy
with. There are some other weird over plotting edge things you can
utilise to make the uncertainty implicitly represented by some other
aesthetic (like thickness), but in general the approaches all look
similar (and convey similar information)</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># uncertainty indicated by transparency</span></span>
<span><span class="fu">ggraph</span><span class="op">(</span><span class="va">graph_sample</span>, layout <span class="op">=</span> <span class="st">'fr'</span>, weights <span class="op">=</span> <span class="va">weight</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_edge_link</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group<span class="op">=</span><span class="va">drawID</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.005</span>,</span>
<span>                 linewidth<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_node_point</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="A_how-to-guide_files/figure-html/graph4-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Thickness = probability of an edge (thicker = more probable)</span></span>
<span><span class="fu">ggraph</span><span class="op">(</span><span class="va">graph_sample</span>, layout <span class="op">=</span> <span class="st">'fr'</span>, weights <span class="op">=</span> <span class="va">weight</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_edge_parallel0</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group<span class="op">=</span><span class="va">drawID</span><span class="op">)</span>,</span>
<span>                      sep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="st">"mm"</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, linewidth<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_node_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p><img src="A_how-to-guide_files/figure-html/graph4-2.png" class="r-plt" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Harriet Mason, Dianne Cook, Sarah Goodwin, Susan VanderPlas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
