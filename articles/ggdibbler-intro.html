<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>An introduction to ggdibbler • ggdibbler</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An introduction to ggdibbler">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggdibbler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/ggdibbler-intro.html">An introduction to ggdibbler</a></li>
    <li><a class="dropdown-item" href="../articles/random-plots.html">Unexpected by products of uncertain plots</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/harriet-mason/ggdibbler/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>An introduction to ggdibbler</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/harriet-mason/ggdibbler/blob/main/vignettes/ggdibbler-intro.Rmd" class="external-link"><code>vignettes/ggdibbler-intro.Rmd</code></a></small>
      <div class="d-none name"><code>ggdibbler-intro.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="why-use-ggdibbler">Why use <code>ggdibbler</code>?<a class="anchor" aria-label="anchor" href="#why-use-ggdibbler"></a>
</h2>
<p>It may not be obvious from the outset why we would want this package,
after all, there are plenty of geoms and plenty of ways to visualise
distributions, so what is the point of this?</p>
<p>For information to be passed into ggplot2, or any visualisation
software, it usually needs to be expressed as data. This restriction
prevents us from visualising inputs that are too uncertain to be
expressed as single data values. This can include things like estimates,
model predictions, bounded values or observations with large measurement
error.</p>
<p>Now, users can simply replace a vector of data with a vector of
random variables created using <a href="https://github.com/mitchelloharawild/distributional" class="external-link"><code>distributional</code></a>
and visualise these types of inputs using <code>ggdibbler</code>. Any
quantifiable uncertainty can be expressed as a distribution, and any
distribution can be passed to an existing ggplot2 geom with ggdibbler.
Users are not limited by data type (the data can be a random factor,
continuous variable, character, etc) or by type of distribution (it can
be any theoretical distribution, but also an empirical distribution
expressed as a set of samples).</p>
<p><code>ggdibbler</code> incorporates uncertainty into your graphic as
noise and allows you to see how the variation may change the conclusions
you take away from your graphics. The power of ggdibbler is in its
simplicity and flexibility. There is no need to learn specific package
syntax or new functions and you can pass a distribution to ANY
combination of aesthetics in ggplot2.</p>
<p>The value of <code>ggdibbler</code> becomes aparent when we look at a
use cases for the software.</p>
</div>
<div class="section level2">
<h2 id="visualising-uncertainty-as-a-function-of-a-plot">Visualising uncertainty as a function of a plot<a class="anchor" aria-label="anchor" href="#visualising-uncertainty-as-a-function-of-a-plot"></a>
</h2>
<p>If you have taken a look at any <code>ggdibbler</code>,
documentation, you may have noticed that it is a replica of the
<code>ggplot2</code> documentation, right down to the examples. (Almost)
every dataset used in a <code>ggplot2</code> example has a
<code>ggdibbler</code> equivalent, every <code>geom_*</code> and
<code>stat_*</code> is replicated with a <code>geom_*_sample</code> and
<code>stat_*_sample</code> function respectively. We repeatedly show
uncertain plots alongside their certain counterparts.</p>
<p>The philosophy of <code>ggdibbler</code> is that there is no such
thing as an uncertainty visualisation (despite us using the phrase
repeatedly in the documentation), at least not in isolation. Uncertainty
visualisation is the process of incorporating uncertainty into the
graphic, such that we can see how that uncertainty changes the take away
messages of the plot. Every <code>ggdibbler</code> visualisation should
have a <code>ggdplot2</code> comparison, and vice-versa. This is why the
<code>ggdibbler</code> examples, function, and data are presented as
they are. It is to show what a plot looks like if you replace every
single variable with a random variable. Sometimes this makes the dataset
a little odd, e.g. why would we be uncertain about literally every
single variable in <code>mtcars</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    mpg cyl disp</span></span>
<span><span class="co">#&gt; Mazda RX4         21.0   6  160</span></span>
<span><span class="co">#&gt; Mazda RX4 Wag     21.0   6  160</span></span>
<span><span class="co">#&gt; Datsun 710        22.8   4  108</span></span>
<span><span class="co">#&gt; Hornet 4 Drive    21.4   6  258</span></span>
<span><span class="co">#&gt; Hornet Sportabout 18.7   8  360</span></span>
<span><span class="co">#&gt; Valiant           18.1   6  225</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">uncertain_mtcars</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;         mpg</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dist&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> U(20, 22)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> U(21, 21)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> U(22, 24)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> U(21, 22)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> U(17, 20)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> U(17, 19)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: cyl &lt;dist&gt;, disp &lt;dist&gt;</span></span></span></code></pre></div>
<p>But the data sets are more… illustrative than practical. Hopefully
what the data examples lack in sense, they make up for in exploration,
as you can use <code>ggdibbler</code> to investigate the (sometimes
questionable) ways added uncertainty to the variables. The examples
section of this vignette has more practical examples so you can see how
the package actually works in practice.</p>
</div>
<div class="section level2">
<h2 id="using-distributional">Using distributional<a class="anchor" aria-label="anchor" href="#using-distributional"></a>
</h2>
<p><code>ggdibbler</code> is entirely built upon the R package
<code>distributional</code> which allows you to store distributions in a
<code>tibble</code> as distribution objects. I had literally nothing to
do with the package, Mitch, Matt, Alex and Rob have my eternal gratitude
for writing it, but it met almost all my needs when it came to building
<code>ggdibbler</code>. If you have a case of uncertainty you want to
represent, I would seriously suggest having a poke around in
distributional documentation. It is shockingly flexible and I am yet to
come across a case of uncertainty <em>cannot</em> be represented by
<code>distributional</code>.</p>
<ul>
<li>Bounded values? use
<code>dist_uniform(lowerbound, upperbound)</code>
</li>
<li>Uncertain predicted classes? use <code>dist_categorical</code>
</li>
<li>Want to sample values from a specific vector of values (such as a
posterior)? use <code>dist_sample</code>
</li>
</ul>
<p>If you have an uncertainty that can be expressed numerically (which
is unfortunately the most basic prerequisite for plotting anything, not
just uncertainty) then it can almost certainly be captured with a
distribution.</p>
<p>All of the data sets in <code>ggdibbler</code> already have the
distributional component added, but making a distribution vector is
shockingly easy. Below is an example where we make normally distributed
estimates by wrapping our typical estimate and standard error
calculations in a <code>dist_normal</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">toy_temp_eg</span> <span class="op">&lt;-</span> <span class="va">toy_temp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">county_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>temp_dist <span class="op">=</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">recorded_temp</span><span class="op">)</span>,</span>
<span>                                    sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">recorded_temp</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">toy_temp_eg</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 406217.2 ymin: -466551.1 xmax: 722461.8 ymax: -128604.1</span></span>
<span><span class="co">#&gt; Projected CRS: NAD27 / US National Atlas Equal Area</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   county_name    temp_dist</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dist&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Adair County N(30, 0.82)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Adams County    N(30, 1)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Allamakee C…  N(26, 0.3)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Appanoose C… N(23, 0.69)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Audubon Cou…  N(28, 0.8)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Benton Coun…    N(29, 2)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: county_geometry &lt;MULTIPOLYGON [m]&gt;</span></span></span></code></pre></div>
<p>There are also flexibilities that go beyond just the distribution you
choose.</p>
<ul>
<li><p>You can transform distributions using
<code>dist_transformed</code> or make your own distributions if you want
(although I am not sure how difficult that is, I have never had to do
it).</p></li>
<li><p>You can also mix different distributions together (all the
distributions in a variable don’t need to be the same family)</p></li>
<li><p>You can have deterministic (there is a deterministic
distribution) and distributional objects in the same column.</p></li>
</ul>
<p>We will now go onto the <code>ggdibbler</code> specific examples
(this is not the distributional vignette) but it is definitely worth
having a play around in <code>distributional</code> so you understand
the object before jumping straight into <code>ggdibbler</code>
plots.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="a-basic-geom_abline">A basic <code>geom_abline</code><a class="anchor" aria-label="anchor" href="#a-basic-geom_abline"></a>
</h3>
<p>The most basic estimate we can have, is the estimate for a simple
linear regression. A simple linear regression is actually used in the
<code>ggplot2</code> documentation as the example for
<code>geom_abline</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot data</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="ggdibbler-intro_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate slope and intercept of line of best fit</span></span>
<span><span class="co"># get coef and standard error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = mpg ~ wt, data = mtcars)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -4.5432 -2.3647 -0.1252  1.4096  6.8727 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  37.2851     1.8776  19.858  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; wt           -5.3445     0.5591  -9.559 1.29e-10 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 3.046 on 30 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.7528, Adjusted R-squared:  0.7446 </span></span>
<span><span class="co">#&gt; F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ggplot, just error estimate</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">37</span>, slope <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># ggdibbler for coef AND standard error</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/geom_abline_sample.html">geom_abline_sample</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">37</span>, <span class="fl">1.8</span><span class="op">)</span>, slope <span class="op">=</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">0.56</span><span class="op">)</span>,</span>
<span>                       times<span class="op">=</span><span class="fl">30</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span></code></pre></div>
<p><img src="ggdibbler-intro_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" width="700"></p>
<p>A fun aspect of this approach, is that we can simultaneously see the
impact of the variance in the intercept <em>and</em> the wt
coefficient.</p>
</div>
<div class="section level3">
<h3 id="a-more-complicated-geom_sf">A more complicated geom_sf<a class="anchor" aria-label="anchor" href="#a-more-complicated-geom_sf"></a>
</h3>
<p>Ok, I am bored, one simple example is. Lets work through a longer and
more difficult case of uncertainty visualisation, a spatial
visualisation with an uncertain fill. To look at this, we are going to
use one of the example data sets that comes with
<code>ggdibbler</code>,<code>toy_temp</code>.</p>
<p>The <code>toy_temp</code> data set is a simulated data set that
represents observations collected from citizen scientists in several
counties in Iowa. Each county has several measurements made by
individual scientists at the same time on the same day, but their exact
location is not provided to preserve anonymity. Different counties can
have different numbers of citizen scientists and the temperature
measurements can have a significant amount of variance due to the
recordings being made by different people in slightly different
locations within the county. Each recorded temperature comes with the
county the citizen scientist belongs to, the temperature recording the
made, and the scientist’s ID number. There are also variables to define
spatial elements of the county, such as it’s geometry, and the county
centroid’s longitude and latitude.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">toy_temp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 990</span></span>
<span><span class="co">#&gt; Columns: 6</span></span>
<span><span class="co">#&gt; $ county_name      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Lyon County"<span style="color: #949494;">, </span>"Dubuque County"<span style="color: #949494;">, </span>"Crawford County"<span style="color: #949494;">, </span>"…</span></span>
<span><span class="co">#&gt; $ county_geometry  <span style="color: #949494; font-style: italic;">&lt;MULTIPOLYGON [m]&gt;</span> MULTIPOLYGON (((274155.2 -1...<span style="color: #949494;">, </span>MULTIPOL…</span></span>
<span><span class="co">#&gt; $ county_longitude <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 306173.3<span style="color: #949494;">, </span>746092.2<span style="color: #949494;">, </span>381255.2<span style="color: #949494;">, </span>696287.1<span style="color: #949494;">, </span>729905.9<span style="color: #949494;">, </span>306…</span></span>
<span><span class="co">#&gt; $ county_latitude  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -172880.7<span style="color: #949494;">, </span>-239861.5<span style="color: #949494;">, </span>-318675.9<span style="color: #949494;">, </span>-153979.0<span style="color: #949494;">, </span>-280551.9…</span></span>
<span><span class="co">#&gt; $ recorded_temp    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 21.08486<span style="color: #949494;">, </span>28.94271<span style="color: #949494;">, </span>26.39905<span style="color: #949494;">, </span>27.10343<span style="color: #949494;">, </span>34.20208<span style="color: #949494;">, </span>20.…</span></span>
<span><span class="co">#&gt; $ scientistID      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "#74991"<span style="color: #949494;">, </span>"#22780"<span style="color: #949494;">, </span>"#55325"<span style="color: #949494;">, </span>"#46379"<span style="color: #949494;">, </span>"#84259"<span style="color: #949494;">, </span>"#9…</span></span></code></pre></div>
<p>While it is slightly difficult, we can view the individual
observations by plotting them to the centroid longitude and latitude
(with a little jitter) and drawing the counties in the background for
referece.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot Raw Data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">toy_temp</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry<span class="op">=</span><span class="va">county_geometry</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">county_longitude</span>, y<span class="op">=</span><span class="va">county_latitude</span>, colour<span class="op">=</span><span class="va">recorded_temp</span><span class="op">)</span>, </span>
<span>              width<span class="op">=</span><span class="fl">5000</span>, height <span class="op">=</span><span class="fl">5000</span>, alpha<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggdibbler-intro_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" width="700"></p>
<p>Typically, we would not visualise the data this way. A much more
common approach would be to take the average of each county and display
that in a choropleth map, displayed below.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mean data</span></span>
<span><span class="va">toy_temp_mean</span> <span class="op">&lt;-</span> <span class="va">toy_temp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">county_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>temp_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">recorded_temp</span><span class="op">)</span><span class="op">)</span> </span>
<span>  </span>
<span><span class="co"># Plot Mean Data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">toy_temp_mean</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry<span class="op">=</span><span class="va">county_geometry</span>, fill<span class="op">=</span><span class="va">temp_mean</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggdibbler-intro_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" width="700"></p>
<p>This plot is fine, but it does loose a key piece of information,
specifically the understanding that this mean is an estimate. That means
that this estimate has a sampling distribuiton that is invisible to us
when we make this visualisation.</p>
<p>We can see that there is a wave like pattern in the data, but
sometimes spatial patterns are a result of significant differences in
population, and may disappear if we were to include the variance of the
estimates, we can calculate that with the average.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mean and variance data</span></span>
<span><span class="va">toy_temp_est</span> <span class="op">&lt;-</span> <span class="va">toy_temp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">county_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>temp_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">recorded_temp</span><span class="op">)</span>,</span>
<span>            temp_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">recorded_temp</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>Getting an estimate along with its variance is also a common format
governments supply data. Just like in our citizen scientist case, this
if often done to preserve anonymity.</p>
<p>The problem with this format of data, is that there is no way for us
to include the variance information in the visualisation. We can only
visualise the estimate and its variance separately. So, instead of
trying to use the estimate and its variance as different values, we
combine them as a single distribution variable thanks to the
<code>distributional</code> package and then can use it with the
<code>ggdibbler</code> version of <code>geom_sf</code>,
<code>geom_sf_sample</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Distribution</span></span>
<span><span class="va">toy_temp_dist</span> <span class="op">&lt;-</span> <span class="va">toy_temp_est</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>temp_dist <span class="op">=</span> <span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="va">temp_mean</span>, <span class="va">temp_se</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">county_name</span>, <span class="va">temp_dist</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Plot Distribution Data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">toy_temp_dist</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_sf_sample.html">geom_sf_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry<span class="op">=</span><span class="va">county_geometry</span>, fill<span class="op">=</span><span class="va">temp_dist</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ggdibbler-intro_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" width="700"></p>
<p>To maintain flexibility, the <code>geom_sf_sample</code> does not
highlight the original boundary lines, but that can be easily added just
by adding another layer.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">toy_temp_dist</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_sf_sample.html">geom_sf_sample</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">county_geometry</span>, fill<span class="op">=</span><span class="va">temp_dist</span><span class="op">)</span>, linewidth<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">county_geometry</span><span class="op">)</span>, fill<span class="op">=</span><span class="cn">NA</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ggdibbler-intro_files/figure-html/unnamed-chunk-11-1.png" class="r-plt" width="700"></p>
<p>Currently <code>geom_sf</code> only accepts a random fill, as it
subdivides the geometry to fill it with a sample. This will eventually
be extended to all the <code>geom_sf</code> aesthetics (which is the
case for all other geometries in <code>ggdibbler</code>)</p>
</div>
</div>
<div class="section level2">
<h2 id="limitations-of-the-package">Limitations of the Package<a class="anchor" aria-label="anchor" href="#limitations-of-the-package"></a>
</h2>
<p>There are three primary limitations of the software to keep in mind.
First, it only allows you to visualise the distribution as a sample. We
are planning to expand this to quantiles in later version, but it is not
currently an option. Second, if multiple distributions are passed, they
are assumed to be independent. This is also something we are hoping to
fix in later versions (possibly with a covariance matrix or a dibble
object that represents joint distributions). Finally, replacing a single
value with a sample of values (which is functionally what ggdibbler
does) results in pervasive overplotting issue. We are hoping to mediate
this with nested positions and sensible geom defaults, but this can be
difficult to manage depending on the type of plot. In general, we
recommend <em>always</em> setting <code>alpha&lt;=0.5</code> the first
time you make a plot.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Harriet Mason, Dianne Cook, Sarah Goodwin, Susan VanderPlas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
