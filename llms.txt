# `ggdibbler`

For information to be passed into ggplot2, or any visualisation
software, it usually needs to be expressed as data. This restriction
prevents us from visualising inputs that are too uncertain to be
expressed as single data values. This can include things like estimates,
model predictions, bounded values or observations with large measurement
error.

Now, users can simply replace a vector of data with a vector of random
variables created using
[`distributional`](https://github.com/mitchelloharawild/distributional)
and visualise these types of inputs using `ggdibbler`. Any quantifiable
uncertainty can be expressed as a distribution, and any distribution can
be passed to an existing `ggplot2` geom with `ggdibbler`. Users are not
limited by data type, the data can be continuous or discrete, sf
objects, character or factors, or even other distributions. You are also
not limited to any type of distribution, theoretical, empirical,
truncated, and mixed distributions are all allowed by `distributional`
and therefore accepted by `ggdibbler`. No matter what you pass,
`ggdibbler` will incorporate the uncertainty into your graphic as noise
and allows you to see how the variation may change the conclusions you
take away from your graphics.

The power of `ggdibbler` is in its simplicity and flexibility. There is
no need to learn specific package syntax or new functions and you can
pass a distribution to ANY combination of aesthetics in ggplot2. It is a
universal, exploratory tool for uncertainty visualisation.

## Installation

You can install the stable version of `ggdibbler` from CRAN with:

``` r
# install.packages("pak")
install.packages("ggdibbler")
```

or you can install the development version of `ggdibbler` from
[GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("harriet-mason/ggdibbler")
```

## Examples

In essence, `ggdibbler` makes visualising uncertainty easy, as you just
replace the `geom_*` with `geom_*_sample` and replace your deterministic
variable with a `distributional` variable, and you get an uncertainty
visualisation.

You will often run into an overplotting problem when visualising
uncertainty, so using a jitter or adjusting the alpha value will allow
you to see all outcomes of the distribution. Otherwise you will only see
the final draw.

Below are some examples of `ggdibbler` code alongside their uncertain
`ggplot2` counterpart. The only parameters added by `ggdibbler` are the
`times` argument, which decides how many samples to draw from the
distribution, and the `seed` argument which allows you to keep the same
random draw across multiple layers.

``` r
library(distributional)
library(dplyr)
library(sf)
library(ggplot2)
library(ggdibbler)
library(patchwork)

set.seed(1343)
```

``` r
p1 <- ggplot(faithfuld, aes(waiting, eruptions, z = density)) + 
  ggtitle("ggplot2") +
  geom_contour()

p2 <- ggplot(uncertain_faithfuld, aes(waiting, eruptions, z = density0))+
  ggtitle("ggdibbler") +
  geom_contour_sample(alpha=0.2)

p1 + p2
```

![](reference/figures/README-unnamed-chunk-3-1.png)

Overlapping positions in other geom can be fixed with standard position
adjustments, such as `position = "identity_dodge"` where the position of
the original plot is an `identity`, and the position adjustment specific
to the draws is a `dodge`.

``` r

p1 <- ggplot(faithfuld, aes(waiting, eruptions)) + 
  geom_raster(aes(fill = density)) +
  ggtitle("ggplot2")+
  theme(legend.position = "bottom")

p2 <- ggplot(uncertain_faithfuld, aes(waiting, eruptions)) + 
  geom_raster_sample(aes(fill = density)) +
  ggtitle("ggdibbler some error")+
  theme(legend.position = "bottom")

p3 <- ggplot(uncertain_faithfuld, aes(waiting, eruptions)) + 
  geom_raster_sample(aes(fill = density2)) +
  ggtitle("ggdibbler more error")+
  theme(legend.position = "bottom")

p1  + p2 + p3
```

![](reference/figures/README-unnamed-chunk-4-1.png)

You can mix and match positions to get some interesting looking graphics
that all converge to the same `ggplot2` plot.

``` r
p1 <- ggplot(mpg, aes(class)) + 
  geom_bar_sample(aes(fill = drv), 
                  position = "stack")+
  theme(legend.position="none")+
  ggtitle("stack")


p2 <- ggplot(uncertain_mpg, aes(class)) + 
  geom_bar_sample(aes(fill = drv), alpha=0.15,
                  position = "stack_identity")+
  theme(legend.position="none")+
  ggtitle("stack_identity")

p3 <- ggplot(uncertain_mpg, aes(class)) + 
  geom_bar_sample(aes(fill = drv),
                  position = "stack_dodge")+
  theme(legend.position="none")+
  ggtitle("stack_dodge")

p1 | p2 | p3
```

![](reference/figures/README-unnamed-chunk-5-1.png)

The only geoms that implement new positioning (i.e. not nested versions
of existing `ggplot2` positions) are `geom_sf_sample`, and
`geom_pollygon_sample`. These geometries use the `subdivide` position
which is inspired by the pixel map implemented in
[Vizumap](https://github.com/lydialucchesi/Vizumap).

``` r
# Make average summary of data
toy_temp_mean <- toy_temp |> 
  dplyr::group_by(county_name) |>
  summarise(temp_mean = mean(recorded_temp))

# plot it
p1 <- ggplot(toy_temp_mean) +
  geom_sf(aes(geometry=county_geometry, fill=temp_mean), linewidth=0.7) +
  scale_fill_distiller(palette = "OrRd") +
  labs(fill="temp")+
  ggtitle("ggplot2")+
  theme(legend.position = "bottom")

# sample map
p2 <- toy_temp_dist |> 
  ggplot() + 
  geom_sf_sample(aes(geometry = county_geometry, fill=temp_dist), linewidth=0, times=50) + 
  geom_sf(aes(geometry = county_geometry), fill=NA, linewidth=0.7) +
  scale_fill_distiller(palette = "OrRd") +
  labs(fill="temp")+
  ggtitle("ggdibbler")+
  theme(legend.position = "bottom")

p1+p2
```

![](reference/figures/README-unnamed-chunk-6-1.png)

## Limitations of the Package

There are three primary limitations of the software to keep in mind.
First, it only allows you to visualise the distribution as a sample. We
are planning to expand this to quantiles in later versions but it is not
currently an option. Second, if multiple distributions are passed, they
are assumed to be independent. This is actually not as much of a
limitation as people think, there are often a simple work around in most
cases, but it isn’t as frictionless as we would like. Finally, all
desired scale and position functions are not always available as we
built the minimum required level of nesting before this release. This is
another feature we hope to build up in the future.

## Future additions to the package

Future plans for `ggdibbler` are tracked in the [Github
issues](https://github.com/harriet-mason/ggdibbler/issues). If you have
a suggestion or bug, please let us know!

# Package index

## Geoms

The uncertainty equivalent of the ggplot geom functions. This is how you
will typically interact with ggdibbler, as it is how you usually
interact with ggplot2.

- [`geom_abline_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_abline_sample.md)
  [`geom_hline_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_abline_sample.md)
  [`geom_vline_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_abline_sample.md)
  : Reference lines with uncertainty: horizontal, vertical, and diagonal
- [`geom_bar_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_bar_sample.md)
  [`geom_col_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_bar_sample.md)
  [`stat_count_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_bar_sample.md)
  : Uncertain Bar Charts
- [`geom_bin_2d_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_bin_2d_sample.md)
  [`stat_bin_2d_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_bin_2d_sample.md)
  : Uncertain heatmap of 2d bin counts
- [`geom_boxplot_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_boxplot_sample.md)
  [`stat_boxplot_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_boxplot_sample.md)
  : An uncertain box and whiskers plot (in the style of Tukey)
- [`geom_contour_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_contour_sample.md)
  [`geom_contour_filled_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_contour_sample.md)
  [`stat_contour_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_contour_sample.md)
  [`stat_contour_filled_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_contour_sample.md)
  : Uncertain 2D contours of a 3D surface
- [`geom_count_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_count_sample.md)
  [`stat_sum_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_count_sample.md)
  : Uncertain Count overlapping points
- [`geom_density_2d_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_density_2d_sample.md)
  [`geom_density_2d_filled_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_density_2d_sample.md)
  [`stat_density_2d_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_density_2d_sample.md)
  [`stat_density_2d_filled_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_density_2d_sample.md)
  : Uncertain contours of a 2D density estimate
- [`geom_density_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_density_sample.md)
  [`stat_density_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_density_sample.md)
  : Visualise densities with Uncertainty
- [`geom_dotplot_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_dotplot_sample.md)
  : Dot plot with uncertainty
- [`geom_hex_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_hex_sample.md)
  [`stat_bin_hex_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_hex_sample.md)
  : Uncertain hexagonal heatmap of 2d bin counts
- [`geom_freqpoly_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_histogram_sample.md)
  [`geom_histogram_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_histogram_sample.md)
  [`stat_bin_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_histogram_sample.md)
  : Histograms and frequency polygons with uncertainty
- [`geom_jitter_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_jitter_sample.md)
  : Uncertain Jittered Points
- [`geom_crossbar_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_linerange_sample.md)
  [`geom_errorbar_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_linerange_sample.md)
  [`geom_linerange_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_linerange_sample.md)
  [`geom_pointrange_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_linerange_sample.md)
  : Vertical intervals: lines, crossbars & errorbars with uncertainty
- [`geom_path_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_path_sample.md)
  [`geom_line_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_path_sample.md)
  [`geom_step_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_path_sample.md)
  : Uncertain Connected observations
- [`geom_point_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_point_sample.md)
  : Visualise Uncertain Points
- [`geom_polygon_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_polygon_sample.md)
  : Uncertain Polygons
- [`geom_qq_line_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_qq_sample.md)
  [`stat_qq_line_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_qq_sample.md)
  [`geom_qq_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_qq_sample.md)
  [`stat_qq_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_qq_sample.md)
  : A quantile-quantile plot with uncertainty
- [`geom_quantile_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_quantile_sample.md)
  [`stat_quantile_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_quantile_sample.md)
  : Quantile regression with uncertainty
- [`geom_ribbon_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_ribbon_sample.md)
  [`geom_area_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_ribbon_sample.md)
  [`stat_align_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_ribbon_sample.md)
  : Ribbons and area plots with uncertainty
- [`geom_rug_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_rug_sample.md)
  : Uncertain Rug plots in the margins
- [`geom_curve_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_segment_sample.md)
  [`geom_segment_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_segment_sample.md)
  : Line segments and curves with uncertainty
- [`geom_sf_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_sf_sample.md)
  : Visualise Sf Objects with Uncertainty
- [`geom_smooth_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_smooth_sample.md)
  [`stat_smooth_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_smooth_sample.md)
  : Uncertain Smooth
- [`geom_spoke_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_spoke_sample.md)
  : Line segments parameterised by location, direction and distance,
  with uncertainty
- [`geom_label_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_text_sample.md)
  [`geom_text_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_text_sample.md)
  : Uncertain Text
- [`geom_raster_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_tile_sample.md)
  [`geom_rect_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_tile_sample.md)
  [`geom_tile_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_tile_sample.md)
  : Plot rectangles with uncertainty
- [`geom_violin_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_violin_sample.md)
  [`stat_ydensity_sample()`](https://harriet-mason.github.io/ggdibbler/reference/geom_violin_sample.md)
  : Violin plots with uncertainty

## Stats

These are the ggdibbler versions of the layer better specified by the
stats in the ggplot documentation.

- [`sample_expand()`](https://harriet-mason.github.io/ggdibbler/reference/sample_expand.md)
  [`dibble_to_tibble()`](https://harriet-mason.github.io/ggdibbler/reference/sample_expand.md)
  : Simulate outcomes from dibble to make a tibble
- [`stat_identity_sample()`](https://harriet-mason.github.io/ggdibbler/reference/stat_identity_sample.md)
  : Generates a sample from a distribution
- [`stat_ecdf_sample()`](https://harriet-mason.github.io/ggdibbler/reference/stat_ecdf_sample.md)
  : Compute uncertain empirical cumulative distributions
- [`stat_ellipse_sample()`](https://harriet-mason.github.io/ggdibbler/reference/stat_ellipse_sample.md)
  : Compute normal data ellipses with uncertainty
- [`stat_connect_sample()`](https://harriet-mason.github.io/ggdibbler/reference/stat_connect_sample.md)
  : Connect uncertain observations
- [`stat_manual_sample()`](https://harriet-mason.github.io/ggdibbler/reference/stat_manual_sample.md)
  : Manually compute transformations with uncertainty
- [`stat_summary_2d_sample()`](https://harriet-mason.github.io/ggdibbler/reference/stat_summary_2d_sample.md)
  [`stat_summary_hex_sample()`](https://harriet-mason.github.io/ggdibbler/reference/stat_summary_2d_sample.md)
  : Bin and summarise in 2d (rectangle & hexagons) with uncertain inputs
- [`stat_summary_bin_sample()`](https://harriet-mason.github.io/ggdibbler/reference/stat_summary_sample.md)
  [`stat_summary_sample()`](https://harriet-mason.github.io/ggdibbler/reference/stat_summary_sample.md)
  : Summarise y values at unique/binned x with uncertainty
- [`stat_unique_sample()`](https://harriet-mason.github.io/ggdibbler/reference/stat_unique_sample.md)
  : Remove duplicates (with uncertainty?)

## Position

These positions allow you to nest the distribution overplotting within a
different ggplot2 position adjustment

- [`position_dodge_dodge()`](https://harriet-mason.github.io/ggdibbler/reference/position_dodge_nested.md)
  [`position_dodge_identity()`](https://harriet-mason.github.io/ggdibbler/reference/position_dodge_nested.md)
  [`position_identity_dodge()`](https://harriet-mason.github.io/ggdibbler/reference/position_dodge_nested.md)
  : Nested dodge positions
- [`position_identity_identity()`](https://harriet-mason.github.io/ggdibbler/reference/position_identity_identity.md)
  : Nested identity positions
- [`position_nest()`](https://harriet-mason.github.io/ggdibbler/reference/position_nest.md)
  : Any combination of nested positions
- [`position_stack_identity()`](https://harriet-mason.github.io/ggdibbler/reference/position_stack_nested.md)
  [`position_stack_dodge()`](https://harriet-mason.github.io/ggdibbler/reference/position_stack_nested.md)
  : Nested stack positions
- [`position_subdivide()`](https://harriet-mason.github.io/ggdibbler/reference/position_subdivide.md)
  : Subdivide position aesthetic in a geometry

## Scale

These scales support allow distributions to be passed to ggplot with
ease. They identify the scale type needed, and allow you to personalise
the limits/labels of continuous x and y axis.

- [`scale_x_continuous_distribution()`](https://harriet-mason.github.io/ggdibbler/reference/scale_continuous_distribution.md)
  [`scale_y_continuous_distribution()`](https://harriet-mason.github.io/ggdibbler/reference/scale_continuous_distribution.md)
  : Position scales for continuous distributions
- [`scale_x_discrete_distribution()`](https://harriet-mason.github.io/ggdibbler/reference/scale_discrete_distribution.md)
  [`scale_y_discrete_distribution()`](https://harriet-mason.github.io/ggdibbler/reference/scale_discrete_distribution.md)
  : Position scales for discrete distributions
- [`scale_type(`*`<distribution>`*`)`](https://harriet-mason.github.io/ggdibbler/reference/scale_type.distribution.md)
  : Sets scale for distributions

## Data

ggdibbler comes with a handful of data sets with uncertain values to
show the use of the package. Most of these datasets are ggplot2 datasets
with uncertainty added in.

- [`toy_temp_dist`](https://harriet-mason.github.io/ggdibbler/reference/toy_temp_dist.md)
  : A toy data set that provides data for a map with the temperature of
  each area represented by a random variable.
- [`toy_temp`](https://harriet-mason.github.io/ggdibbler/reference/toy_temp.md)
  : A toy data set that has the ambient temperature as measured by a
  collection of citizen scientists for each Iowa county
- [`smaller_diamonds`](https://harriet-mason.github.io/ggdibbler/reference/smaller_uncertain_diamonds.md)
  [`uncertain_diamonds`](https://harriet-mason.github.io/ggdibbler/reference/smaller_uncertain_diamonds.md)
  : An uncertain (and shrunk down) version of the diamonds data
  from\`ggplot2\`
- [`uncertain_mpg`](https://harriet-mason.github.io/ggdibbler/reference/uncertain_mpg.md)
  : An uncertain version of the MPG data from \`ggplot2\`
- [`uncertain_mtcars`](https://harriet-mason.github.io/ggdibbler/reference/uncertain_mtcars.md)
  : An uncertain version of the mtcars data from base R \`datasets\`
- [`uncertain_economics_long`](https://harriet-mason.github.io/ggdibbler/reference/uncertain_economics.md)
  : An uncertain version of the economics data from\`ggplot2\`
- [`uncertain_faithfuld`](https://harriet-mason.github.io/ggdibbler/reference/uncertain_faithfuld.md)
  : 2d density estimate of Old Faithful data with uncertainty
- [`uncertain_faithful`](https://harriet-mason.github.io/ggdibbler/reference/uncertain_faithful.md)
  : Old Faithful data with uncertainty
- [`walktober`](https://harriet-mason.github.io/ggdibbler/reference/walktober.md)
  : Step Counts from Walktober 2025 Challenge

# Articles

### All vignettes

- [Get started with
  ggdibbler](https://harriet-mason.github.io/ggdibbler/articles/A_how-to-guide.md):
- [The philosophy of
  ggdibbler](https://harriet-mason.github.io/ggdibbler/articles/B_ggdibbler-philosophy.md):
- [Unexpected behaviour of random
  plots](https://harriet-mason.github.io/ggdibbler/articles/C_random-plots.md):
- [Help for ggplot
  extenders](https://harriet-mason.github.io/ggdibbler/articles/D_extender-info.md):
